!function(e){function t(t){for(var a,i,l=t[0],c=t[1],u=t[2],m=0,d=[];m<l.length;m++)i=l[m],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&d.push(r[i][0]),r[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);for(s&&s(t);d.length;)d.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,l=1;l<n.length;l++){var c=n[l];0!==r[c]&&(a=!1)}a&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},r={0:0},o=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/static/";var l=window.webpackJsonp=window.webpackJsonp||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var s=c;o.push([649,1]),n()}({1085:function(e,t){},1086:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(19),i=n.n(o),l=n(46),c=n(20),u=n(224),s=n.n(u),m=s.a.create({baseURL:"/api/",timeout:5e3,headers:{Authorization:localStorage.getItem("access_token")?"JWT "+localStorage.getItem("access_token"):null,"Content-Type":"application/json",accept:"application/json"}}),d=s.a.create({baseURL:"/api/friends/"}),p=s.a.create({baseURL:"api/map/"}),f=s.a.create({baseURL:"api/user/"});m.interceptors.response.use((function(e){return e}),(function(e){var t=e.config;if(401===e.response.status&&t.url===baseURL+"token/refresh/")return window.location.href="/login/",Promise.reject(e);if("token_not_valid"===e.response.data.code&&401===e.response.status&&"Unauthorized"===e.response.statusText){var n=localStorage.getItem("refresh_token");if(n){var a=JSON.parse(atob(n.split(".")[1])),r=Math.ceil(Date.now()/1e3);if(a.exp>r)return m.post("/token/refresh/",{refresh:n}).then((function(e){return localStorage.setItem("access_token",e.data.access),localStorage.setItem("refresh_token",e.data.refresh),m.defaults.headers.Authorization="JWT "+e.data.access,t.headers.Authorization="JWT "+e.data.access,m(t)})).catch((function(e){console.log(e.response)}));console.log("Refresh token is expired",a.exp,r),window.location.href="/login/"}else console.log("Refresh token not available."),window.location.href="/login/"}return Promise.reject(e)}));var g=function(e){return f.get("get/username=".concat(e))},b=function(e,t){return f.patch("update/username=".concat(e),t)},y=function(){return p.get("guideMap/")},h=function(e,t){return p.patch("guideMap/".concat(e,"/"),t)},v=function(){return d.get("friendsGroup/")},E=function(e,t){return d.patch("friendsGroup/".concat(e,"/"),t)},w=function(){return d.get("friendsGroupComments/")},x=m,O=n(1124),S=n(1141),j=n(91);function k(){return(k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var _=function(e){return r.a.createElement(S.a,k({elevation:6,variant:"filled"},e))},D=Object(j.a)((function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}}}})),C=function(e){var t=D(),n=e.onClose,a=e.open,o=function(e){n(e)};return r.a.createElement("div",{className:t.root},r.a.createElement(O.a,{open:a,autoHideDuration:1e3,onClose:o},r.a.createElement(_,{onClose:o,severity:"success"},"更新成功！")))};function I(){return(I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var A=function(e){return r.a.createElement(S.a,I({elevation:6,variant:"filled"},e))},T=Object(j.a)((function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}}}})),B=function(e){var t=T(),n=e.onClose,a=e.open,o=function(e){n(e)};return r.a.createElement("div",{className:t.root},r.a.createElement(O.a,{open:a,autoHideDuration:1e3,onClose:o},r.a.createElement(A,{onClose:o,severity:"error"},"資料有誤！")))},P=(n(203),n(333)),G=n(1125),N=n(534),F=n(428),M=n.n(F),z=n(163),L=n(1140),W=n(1127),U=n(73),R=n(405),V=n(626),q=n.n(V),K=n(432),J=n.n(K),$=n(628),Y=n.n($),H=n(629),Q=n.n(H),X=n(627),Z=n.n(X),ee=n.p+"9fce7792cbfb8fd9dddf6b69e97a126c.jpg";function te(){return(te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ne(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(a=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return re(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var oe=Object(j.a)((function(e){return{root:{"& .MuiTextField-root":{margin:e.spacing(1),fontSize:"20px"}},button:{margin:10,paddingTop:20},input:{display:"none"},icon:{margin:e.spacing(2)},iconHover:{margin:e.spacing(2),"&:hover":{color:M.a[800]}},tab:{fontSize:"16px",marginTop:"10px",marginBottom:"10px"},tabs:{borderRight:"1px solid ".concat(e.palette.divider)},tabroot:{fontSize:"16px",flexGrow:1,backgroundColor:e.palette.background.paper,display:"flex",height:500}}})),ie=function(e){var t=oe(),n=r.a.useContext(sa).state,o=(r.a.useContext(sa).dispatch,ae(Object(a.useState)({mainState:"initial",selectedFile:null,imageUploaded:0}),2)),i=(o[0],o[1],ae(Object(a.useState)([]),2)),c=i[0],u=(i[1],ae(Object(a.useState)([]),2)),s=u[0],m=(u[1],localStorage.getItem("access_token"),localStorage.getItem("refresh_token"),localStorage.getItem("username"),[]);null!=e.dbFriendsGroupData?m=e.dbFriendsGroupData.filter((function(e){return e.create_user==n.username})):null!=s&&(m=s.filter((function(e){return e.create_user==n.username})),console.log(n.username));var d=ae(r.a.useState(!1),2),p=(d[0],d[1],ae(r.a.useState(!1),2)),f=(p[0],p[1],ae(r.a.useState(!1),2)),y=(f[0],f[1],ae(r.a.useState(!1),2)),h=(y[0],y[1],ae(r.a.useState(!1),2)),v=h[0],E=h[1],w=ae(r.a.useState(!1),2),x=w[0],O=w[1],S=ae(Object(a.useState)(""),2),j=S[0],k=S[1],_=function(t){e.updateUserDB(t.target),"password"==t.target.name&&k(t.target.value)};Object(a.useEffect)((function(){g(n.username).then((function(t){console.table(t.data),e.initUserDB(t.data)})).catch((function(e){console.error(e.response)})).finally((function(){}))}),[]);var D=function(t){t.preventDefault(),console.table("submit"),b(n.username,e.userData).then((function(e){E(!0)})).catch((function(e){console.error(e.response)})).finally((function(){}))},I=ae(r.a.useState(0),2),A=I[0],T=I[1],F=function(e,t){T(t)},M=function(e){var t=e.children,n=e.value,a=e.index,o=(e.classes,ne(e,["children","value","index","classes"]));return r.a.createElement("div",te({role:"tabpanel",hidden:n!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},o),n===a&&r.a.createElement(G.a,null,r.a.createElement(R.a,{p:3},r.a.createElement(U.a,null,t))))};function V(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}var K=function(){return r.a.createElement(N.a,{container:!0,style:{width:"90%",marginBottom:50,marginLeft:"auto",marginRight:"auto"}},r.a.createElement("div",{className:t.tabroot,style:{display:"flex"}},r.a.createElement(L.a,{orientation:"vertical",variant:"scrollable",value:A,onChange:F,"aria-label":"Vertical tabs example",className:t.tabs},r.a.createElement(W.a,te({label:"地圖"},V(0),{className:t.tab})),r.a.createElement(W.a,te({label:"揪團"},V(1),{className:t.tab})),r.a.createElement(W.a,te({label:"修改個人資料"},V(2),{className:t.tab}))),r.a.createElement(M,{value:A,index:0},r.a.createElement(N.a,{container:!0},r.a.createElement(q.a,null),r.a.createElement("div",{style:{marginBottom:10}},"新增地點 :"),r.a.createElement("ul",null,null!=e.userData.map_add||null!=e.userData.map_add?e.userData.map_add.map((function(t,n){var a=null;return null!=e.dbGuideMapData||null!=e.dbGuideMapData?a=e.dbGuideMapData.find((function(e){return e.location_id==t})):null!=c&&(a=c.find((function(e){return e.location_id==t}))),r.a.createElement("li",{style:{listStyleType:"decimal"}},a.location_type," ",a.location_name,":"," ",a.address)})):r.a.createElement("span",null,"還沒有"))),r.a.createElement(N.a,{container:!0},r.a.createElement(J.a,null),r.a.createElement("span",null,"最愛地點 :"),r.a.createElement("ul",null,null!=e.userData.map_like||null!=e.userData.map_like?e.userData.map_like.map((function(t,n){var a=[];return null!=e.dbGuideMapData||null!=e.dbGuideMapData?a=e.dbGuideMapData.find((function(e){return e.location_id==t})):null!=c&&(a=c.find((function(e){return e.location_id==t}))),r.a.createElement("li",{style:{listStyleType:"decimal"}},a.location_type," ",a.location_name,":"," ",a.address)})):r.a.createElement("span",null,"還沒有")))),r.a.createElement(M,{value:A,index:1},r.a.createElement(N.a,{container:!0},r.a.createElement(Z.a,null),"舉辦中 :",r.a.createElement("ul",null,null!=m||null!=m?m.map((function(e,t){return r.a.createElement("li",{style:{listStyleType:"decimal"}},e.group_startdt.slice(0,10)," ",e.group_startdt.slice(11,20)," 在"," ",e.location_name,"(ID:"," ",r.a.createElement(l.c,{to:"/friendsGroupDetail/"+e.group_id,className:"userLink"},e.group_id),")")})):r.a.createElement("span",null,"還沒有"))),r.a.createElement(N.a,{container:!0},r.a.createElement(Y.a,null),"參加中 :",r.a.createElement("ul",null,null!=e.userData.group_join||null!=e.userData.group_join?e.userData.group_join.map((function(t,n){var a=e.dbFriendsGroupData.find((function(e){return e.group_id==t}));return r.a.createElement("li",{style:{listStyleType:"decimal"}},a.group_startdt.slice(0,10)," ",a.group_startdt.slice(11,20)," 在"," ",a.location_name,"(ID:"," ",r.a.createElement(l.c,{to:"/friendsGroupDetail/"+a.group_id,className:"userLink"},a.group_id),")")})):r.a.createElement("span",null,"還沒有"))),r.a.createElement(N.a,{container:!0},r.a.createElement(Q.a,null),"追蹤中 :",r.a.createElement("ul",null,null!=e.userData.group_like||null!=e.userData.group_like?e.userData.group_like.map((function(t,n){var a=e.dbFriendsGroupData.find((function(e){return e.group_id==t}));return r.a.createElement("li",{style:{listStyleType:"decimal"}},a.group_startdt.slice(0,10)," ",a.group_startdt.slice(11,20)," 在"," ",a.location_name,"(ID:"," ",r.a.createElement(l.c,{to:"/friendsGroupDetail/"+a.group_id,className:"userLink"},a.group_id),")")})):r.a.createElement("span",null,"還沒有")))),r.a.createElement(M,{value:A,index:2},r.a.createElement($,null))))},$=function(){return r.a.createElement("form",{className:t.root,noValidate:!0,autoComplete:"off"},r.a.createElement(N.a,{container:!0},r.a.createElement(P.a,{disabled:!0,id:"filled-disabled",label:"帳號",defaultValue:n.username,variant:"filled"}),r.a.createElement(P.a,{onChange:_,id:"filled-password-input",label:"密碼",type:"password",value:j,autoComplete:"current-password",variant:"filled"})),r.a.createElement(N.a,{container:!0},r.a.createElement(P.a,{onChange:_,required:!0,id:"filled-required-email",name:"email",label:"Email(必填)",value:e.userData.email,variant:"filled",style:{width:300}})),r.a.createElement(N.a,{container:!0},r.a.createElement(P.a,{onChange:_,required:!0,id:"filled-required",name:"nickname",label:"暱稱",value:e.userData.nickname,variant:"filled"}),r.a.createElement(P.a,{onChange:_,id:"filled-search",label:"所在城市",name:"location",value:e.userData.location,variant:"filled"})),r.a.createElement(N.a,{container:!0},r.a.createElement(P.a,{onChange:_,id:"filled-multiline-static",label:"自我介紹",name:"intro",multiline:!0,style:{width:400},rows:5,value:e.userData.intro,variant:"filled"})),r.a.createElement(z.a,{onClick:D,type:"submit",variant:"contained",color:"primary",className:t.submit,style:{marginLeft:5}},"確認修改"))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(C,{open:v,onClose:function(){E(!1)}}),r.a.createElement(B,{open:x,onClose:function(){O(!1)}}),r.a.createElement(G.a,{className:"user_conatainer",component:"main",maxWidth:"lg",style:{marginLeft:"auto",marginRight:"auto"}},r.a.createElement(N.a,{container:!0,style:{marginTop:70,marginBottom:20,display:"flex"}},r.a.createElement("img",{src:"https://ui-avatars.com/api/?name=".concat(n.username,"&size=128&rounded=true&background=040404&color=fff")}),r.a.createElement("div",{style:{marginLeft:50}},r.a.createElement("h2",null,"暱稱：",e.userData.nickname),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("span",null,"@",n.username),r.a.createElement("span",null)))),r.a.createElement(K,null)))},le=n(1144),ce=n(1130),ue=n(437),se=n.n(ue),me=n(212),de=n(1129),pe=n(164),fe=n.n(pe),ge=n(148),be=n.n(ge);function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function he(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach((function(t){ve(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(a=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return we(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return we(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function we(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var xe=Object(j.a)((function(e){return{back:{backgroundColor:"#fcf3ea"},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.primary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}})),Oe=Object(me.a)({palette:{primary:{light:fe.a[300],main:fe.a[500],dark:fe.a[700]},secondary:{light:be.a[300],main:be.a[500],dark:be.a[700]},background:{default:"#fcf3ea"}}}),Se=function(){var e=xe(),t=Object(c.g)(),n=Ee(r.a.useState({username:"",password:"",email:"",errorMsg:{},isUsernameFilled:!0,isEmailFilled:!0,isPasswordValid:!0}),2),a=n[0],o=n[1],i=function(e){var t,n;if(o(he(he({},a),{},(ve(t={},e.target.name,e.target.value),ve(t,"isUsernameFilled",!1),ve(t,"isEmailFilled",!1),ve(t,"isPasswordValid",!1),t))),"username"==e.target.name&&0==e.target.value.length)o(he(he({},a),{},(ve(n={},e.target.name,e.target.value),ve(n,"isUsernameFilled",!1),n)));else if("email"==e.target.name&&0==e.target.value.length){var r;o(he(he({},a),{},(ve(r={},e.target.name,e.target.value),ve(r,"isEmailFilled",!1),r)))}else if("password"==e.target.name&&e.target.value.length<8){var i;o(he(he({},a),{},(ve(i={},e.target.name,e.target.value),ve(i,"isPasswordValid",!1),i)))}else{var l;o(he(he({},a),{},(ve(l={},e.target.name,e.target.value),ve(l,"isPasswordValid",!0),ve(l,"isUsernameFilled",!0),ve(l,"isEmailFilled",!0),l)))}};return r.a.createElement(G.a,{component:"main",maxWidth:"xs"},r.a.createElement(de.a,{theme:Oe},r.a.createElement(ce.a,null)),r.a.createElement("div",{className:e.paper},r.a.createElement(le.a,{className:e.avatar},r.a.createElement(se.a,null)),r.a.createElement(U.a,{component:"h1",variant:"h5"},"註冊"),r.a.createElement("form",{className:e.form,noValidate:!0,onSubmit:function(e){var n;e.preventDefault(),(n={username:a.username,email:a.email,password:a.password},m.post("/user/create/",n)).then((function(){alert("註冊成功！"),t.push("/")})).catch((function(e){console.log(e.response),o(he(he({},a),{},{errorMsg:e.message||e.statusText}))}))}},a.isUsernameFilled?r.a.createElement(P.a,{value:a.username,onChange:i,variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"username",label:"帳號",name:"username",autoComplete:"username",autoFocus:!0}):r.a.createElement(P.a,{error:!0,value:a.username,onChange:i,variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"username",label:"帳號",name:"username",autoComplete:"username",autoFocus:!0,helperText:"帳號不可為空!"}),a.isEmailFilled?r.a.createElement(P.a,{value:a.email,onChange:i,variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email",name:"email",autoComplete:"email"}):r.a.createElement(P.a,{error:!0,value:a.email,onChange:i,variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email",name:"email",autoComplete:"email",helperText:"Email不可為空!"}),a.isPasswordValid?r.a.createElement(P.a,{value:a.password,onChange:i,variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"密碼",type:"password",id:"password",autoComplete:"current-password"}):r.a.createElement(P.a,{error:!0,value:a.password,onChange:i,variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"密碼",type:"password",id:"password",autoComplete:"current-password",helperText:"密碼需大於八位!"}),r.a.createElement(z.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit},"註冊"),r.a.createElement(N.a,{container:!0,style:{marginBottom:50}},r.a.createElement("div",{className:"sign_up"},"已經有帳號嗎？",r.a.createElement(l.c,{to:"/login/",className:"userLink"},"按我登入"))))),r.a.createElement(c.d,null,r.a.createElement(c.b,{exact:!0,path:"/login/",component:Ge})))},je=n(535),ke=n(438),_e=n.n(ke);function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(Object(n),!0).forEach((function(t){Ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(a=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Te(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Be=Object(j.a)((function(e){return{back:{backgroundColor:"#fcf3ea"},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}})),Pe=Object(me.a)({palette:{primary:{light:fe.a[300],main:fe.a[500],dark:fe.a[700]},secondary:{light:be.a[300],main:be.a[500],dark:be.a[700]},background:{default:"#fcf3ea"}}}),Ge=function(e){var t=Be(),n=Object(c.g)(),o=Object(a.useContext)(sa).dispatch,i=Ae(Object(a.useState)({username:"",password:"",isSubmitting:!0,errorMsg:null}),2),u=i[0],s=i[1],d=function(e){s(Ce(Ce({},u),{},Ie({},e.target.name,e.target.value)))};return null!=localStorage.getItem&&Object(a.useEffect)((function(){g(u.username).then((function(t){console.table(t.data),e.initUserDB(t.data)})).then((function(){n.push("/")})).catch((function(e){console.error(e.response)})).finally((function(){}))}),[]),r.a.createElement(G.a,{component:"main",maxWidth:"xs"},r.a.createElement(de.a,{theme:Pe},r.a.createElement(ce.a,null)),r.a.createElement("div",{className:t.paper},r.a.createElement(le.a,{className:t.avatar},r.a.createElement(_e.a,null)),r.a.createElement(U.a,{component:"h1",variant:"h5"},"登入"),r.a.createElement("form",{className:t.form,noValidate:!0,onSubmit:function(t){var a;t.preventDefault(),s(Ce(Ce({},u),{},{isSubmitting:!0,errorMsg:null})),(a={username:u.username,password:u.password},m.post("/token/obtain/",a)).then((function(e){return x.defaults.headers.Authorization="JWT "+e.data.access,localStorage.setItem("access_token",e.data.access),localStorage.setItem("refresh_token",e.data.refresh),localStorage.setItem("username",u.username),e})).then((function(e){o({type:"LOGIN",payload:e})})).then((function(){""!=u.username&&g(u.username).then((function(t){console.table(t.data),e.initUserDB(t.data)})),n.push("/")})).catch((function(e){s(Ce(Ce({},u),{},{isSubmitting:!1,errorMsg:e.message||e.statusText}))}))}},r.a.createElement(P.a,{value:u.username,onChange:d,variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"username",label:"帳號",name:"username",autoComplete:"username",autoFocus:!0}),u.isSubmitting?r.a.createElement(P.a,{value:u.password,onChange:d,variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"密碼",type:"password",id:"password",autoComplete:"current-password"}):r.a.createElement(P.a,{error:!0,value:u.password,onChange:d,variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"密碼",type:"password",id:"password",autoComplete:"current-password",helperText:"密碼錯誤，請再試一次．"}),r.a.createElement(z.a,{type:"submit",fullWidth:!0,variant:"contained",style:{backgroundColor:"#188af2",color:"white"},className:t.submit},"登入"),r.a.createElement(N.a,{container:!0},r.a.createElement(N.a,{item:!0,xs:!0},r.a.createElement(je.a,{href:"#",variant:"body2"},"忘記密碼?")),r.a.createElement(N.a,{item:!0},"還沒有帳號嗎？",r.a.createElement(l.c,{to:"/signup/",className:"userLink"},"按我註冊"))))),r.a.createElement(c.d,null,r.a.createElement(c.b,{exact:!0,path:"/signup/",component:Se})),r.a.createElement(R.a,{mt:8}))},Ne=n.p+"c831ead710bf3d309abe0d6b274b9ad9.jpg";n(880);function Fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(a=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Me(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Me(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Me(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var ze=function(){var e=Fe(Object(a.useState)("spin"),2),t=(e[0],e[1],Fe(Object(a.useState)(""),2)),n=t[0],o=t[1];setTimeout((function(){o("Let's Go Skateboarding Together!")}),1500);var i=Fe(Object(a.useState)(""),2),l=(i[0],i[1]);return setTimeout((function(){l("來揪團吧！")}),1500),r.a.createElement("div",{className:"user_conatainer"},r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",null,r.a.createElement("img",{className:"lefttoright",src:Ne,style:{height:500,width:"auto",marginTop:50,marginBottom:70},alt:"banner"})),r.a.createElement("div",{id:"sbgo",style:{fontFamily:"Galindo",marginTop:"auto",marginBottom:"auto",fontSize:60,fontWeight:900,marginLeft:200}},n)))},Le=n(228),We=n(1134),Ue=n(1133),Re=n(1132),Ve=n(1098),qe=n(644),Ke=n(268),Je=n(42),$e=n(412),Ye=n(1097),He=n(1142),Qe=n(567),Xe=n(568),Ze=n(433),et=n(631),tt=n.n(et),nt=n(323),at=n.n(nt),rt=n(165),ot=n.n(rt);function it(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?it(Object(n),!0).forEach((function(t){ct(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):it(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ct(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ut(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(a=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return st(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return st(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function st(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var mt=Object(j.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)},"& .MuiTextField-root":{margin:e.spacing(1)}},modal:{display:"flex",alignItems:"center",justifyContent:"center"},flexContainer:{display:"flex",flexDirection:"row"},paper:{backgroundColor:e.palette.background.paper,boxShadow:e.shadows[5],padding:e.spacing(2,4,3),paddingBottom:20},button:{margin:10,paddingTop:20},card:{maxWidth:345},media:{height:0,paddingTop:"56.25%"},chips:{display:"flex",flexWrap:"wrap"},chip:{margin:2},buttonAdd:{margin:e.spacing(1),marginBottom:20,marginTop:50}}})),dt=function(e){var t=r.a.useContext(sa).state;ot.a.setApiKey("AIzaSyB7KldR4x33szhmh1Q8Vit9YynpWfvcOOs");var n=mt(),o=ut(Object(a.useState)(!1),2),i=o[0],l=o[1],c=ut(Object(a.useState)({location_type:"場地",location_name:"",address:"",latitude:0,longitude:0,traffic:"",intro:"",create_dt:(new Date).toISOString(),update_dt:(new Date).toISOString(),modified_user:t.username}),2),u=c[0],s=c[1],m=ut(Object(a.useState)(),2),d=m[0],f=m[1],g=ut(Object(a.useState)(new Date("2014-08-18T09:00:00")),2),b=g[0],y=g[1],h=ut(Object(a.useState)(new Date("2014-08-18T21:00:00")),2),v=h[0],E=h[1],w=ut(Object(a.useState)(new Date("2014-08-18T09:00:00")),2),x=w[0],O=w[1],S=ut(Object(a.useState)(new Date("2014-08-18T21:00:00")),2),j=S[0],k=S[1],_=ut(Object(a.useState)([r.a.createElement($,null)]),2),D=_[0],I=(_[1],function(e){y(e)}),A=function(e){E(e)},T=function(e){O(e)},G=function(e){k(e)},F=function(e){s(lt(lt({},u),{},ct({},e.target.name,e.target.value)))},M=function(){l(!1)},L=ut(r.a.useState(!1),2),W=L[0],U=L[1],R=ut(r.a.useState(!1),2),V=R[0],q=R[1],K=function(){q(!0)},J=ut(Object(a.useState)([]),2),$=(J[0],J[1],function(){return r.a.createElement(N.a,{container:!0},r.a.createElement(N.a,{container:!0,style:{marginTop:20,marginBottom:10}},"開放時間"),r.a.createElement(Ze.a,{className:n.formControl},r.a.createElement("div",{className:n.flexContainer},r.a.createElement("div",{style:{marginRight:20,paddingRight:70}},"平日"),r.a.createElement(Je.a,{utils:Ke.default},r.a.createElement(N.a,{container:!0},r.a.createElement($e.a,{style:{width:150},margin:"normal",label:"開始",name:"weekdayTimeStart",value:b,onChange:I,KeyboardButtonProps:{"aria-label":"change time"}}),r.a.createElement($e.a,{style:{width:150},margin:"normal",label:"結束",name:"weekdayTimeEnd",value:v,onChange:A,KeyboardButtonProps:{"aria-label":"change time"}})))),r.a.createElement("div",{className:n.flexContainer},r.a.createElement("div",{style:{marginRight:20,paddingRight:20}},"假日與例假日"),r.a.createElement(Je.a,{utils:Ke.default},r.a.createElement(N.a,{container:!0,justify:"space-around"},r.a.createElement($e.a,{style:{width:150},margin:"normal",label:"開始",name:"weekendTimeStart",value:x,onChange:T,KeyboardButtonProps:{"aria-label":"change time"}}),r.a.createElement($e.a,{style:{width:150},margin:"normal",label:"結束",name:"weekendTimeEnd",value:j,onChange:G,KeyboardButtonProps:{"aria-label":"change time"}}))))))});return r.a.createElement(r.a.Fragment,null,r.a.createElement(z.a,{variant:"contained",color:"secondary",className:n.buttonAdd,onClick:function(){l(!0)},startIcon:r.a.createElement(at.a,null)},"新增地點"),r.a.createElement(Ye.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:n.modal,open:i,onClose:M,closeAfterTransition:!0,BackdropComponent:Ve.a,BackdropProps:{timeout:500}},r.a.createElement(C,{open:W,onClose:function(){U(!1)}}),r.a.createElement(B,{open:V,onClose:function(){q(!1)}}),r.a.createElement(qe.a,{in:i},r.a.createElement(N.a,{container:!0,style:{paddingRight:20,paddingLeft:20,paddingBottom:20}},r.a.createElement("h3",{id:"transition-modal-title"},"來新增滑板場或店家吧！"),r.a.createElement("div",{className:n.paper},r.a.createElement("form",{className:n.root,noValidate:!0,autoComplete:"off"},r.a.createElement(Ze.a,{component:"fieldset"},r.a.createElement(Qe.a,{onChange:F,row:!0,"aria-label":"gender",name:"location_type",value:u.location_type},r.a.createElement(Xe.a,{value:"場地",control:r.a.createElement(He.a,null),label:"場地"}),r.a.createElement(Xe.a,{value:"店家",control:r.a.createElement(He.a,null),label:"店家"}))),r.a.createElement(P.a,{onChange:F,size:"small",required:!0,id:"location_name",name:"location_name",label:"名稱",variant:"filled",style:{width:300}}),r.a.createElement(P.a,{onChange:F,size:"small",required:!0,id:"address",name:"address",label:"地址",variant:"filled",fullWidth:!0}),D.map((function(e,t){return r.a.createElement($,{key:t,id:t})})),r.a.createElement(N.a,{container:!0,style:{marginTop:20,marginBottom:10}},"電話:"," ",r.a.createElement(tt.a,{defaultCountry:"tw",onChange:function(e){f(e)}})),r.a.createElement(N.a,{container:!0},r.a.createElement(P.a,{onChange:F,size:"small",id:"traffic",label:"建議交通方式",name:"traffic",variant:"filled",multiline:!0,fullWidth:!0,rows:2})),r.a.createElement(N.a,{container:!0},r.a.createElement(P.a,{onChange:F,size:"small",id:"intro",label:"場地介紹",name:"intro",variant:"filled",multiline:!0,fullWidth:!0,rows:5})),r.a.createElement(z.a,{onClick:function(n){var a;n.preventDefault(),(a=u).modified_user=t.username,a.phone=d,a.openhours={weekdayTimeStart:b.toLocaleTimeString(),weekdayTimeEnd:v.toLocaleTimeString(),weekendTimeStart:x.toLocaleTimeString(),weekendTimeEnd:j.toLocaleTimeString()},a.create_dt=new Date,a.update_dt=new Date;var r=e.userData.map_add;null==r?r=[u.location_name]:r.push(u.location_name);var o={map_add:r};ot.a.enableDebug(),ot.a.fromAddress(u.address).then((function(e){var t=e.results[0].geometry.location,n=t.lat,r=t.lng;s({latitude:n,longitude:r}),a.latitude=n,a.longitude=r}),(function(e){console.error(e)})).then((function(){var n;(n=a,p.post("guideMap/",n)).then((function(t){e.updateDB(a),U(!0),M()})).then((function(){patchUserApi(t.username,o).then((function(t){console.table(t.data),e.updateGroupUserDB(o)})).catch((function(e){K(),console.error(e.response)})).finally((function(){}))})).catch((function(e){K(),console.error(e.response)})).finally((function(){}))}))},type:"submit",variant:"contained",color:"primary",className:n.submit},"確認修改")))))))},pt=n(1145),ft=n(211),gt=n.n(ft),bt=n(635),yt=n.n(bt),ht=n(636),vt=n.n(ht),Et=n(637),wt=n.n(Et),xt=n(634),Ot=n.n(xt),St=n(633),jt=n.n(St),kt=n(563),_t=n(576),Dt=n(435),Ct=n(440),It=n(1135),At=n(1137),Tt=(n(948),n.p+"5adaf296619a55407e1d47b8dfaa4b06.png"),Bt=n(265),Pt=n(345),Gt=n.n(Pt);function Nt(e){return function(e){if(Array.isArray(e))return Ut(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Wt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ft(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ft(Object(n),!0).forEach((function(t){zt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ft(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(a=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(r)throw o}}return n}(e,t)||Wt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wt(e,t){if(e){if("string"==typeof e)return Ut(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ut(e,t):void 0}}function Ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Rt=Object(j.a)((function(e){return{root:{display:"flex",flexWrap:"wrap",listStyle:"none",padding:e.spacing(.5),margin:0,width:"100%"},chip:{margin:e.spacing(.5)},card:{maxWidth:340},media:{height:0,paddingTop:"56.25%"},container:{maxHeight:440},bullet:{display:"inline-block",margin:"0 2px",transform:"scale(0.8)"},title:{fontSize:14},pos:{marginBottom:12},tablecell:{fontSize:16},star:{display:"flex",flexDirection:"column","& > * + *":{marginTop:e.spacing(1)}},listItemText:{fontSize:14},inline:{display:"inline"},hoverRating:{width:200,display:"flex",alignItems:"center",marginRight:20,marginLeft:20,marginBottom:20,marginTop:20},flexContainer:{display:"flex",flexDirection:"column",marginBottom:20},modal:{display:"flex",alignItems:"center",justifyContent:"center"}}})),Vt=function(e){var t=Rt();return e.commentData.some((function(t){return t.map_id===e.locationId}))?r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(Dt.a,{className:t.root},e.commentData.map((function(n,a){if(n.map_id==e.locationId)return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ct.a,{alignItems:"flex-start",key:a},r.a.createElement(At.a,null,r.a.createElement(le.a,{alt:"avatar",src:"https://ui-avatars.com/api/?name=".concat(n.username,"&size=128&rounded=true&background=040404&color=fff")})),r.a.createElement(_t.a,{key:n.comment_id,primary:n.comment_title,secondary:r.a.createElement(r.a.Fragment,{key:n.comment_id+"frag"},r.a.createElement(N.a,{container:!0},r.a.createElement(pt.a,{key:n.comment_id+"rate",name:"half-rating-read",value:n.rating,precision:.5,readOnly:!0})),r.a.createElement(U.a,{component:"span",variant:"body2",className:t.inline,color:"textPrimary"},"".concat(n.username," - ")),n.comment)}),r.a.createElement("span",{style:{fontSize:12,color:"#9a9898",alignItems:"left"}},n.create_dt.toString())),r.a.createElement(kt.a,{variant:"inset",component:"li"}))})))):r.a.createElement(Dt.a,{className:t.root},r.a.createElement("h4",null,"目前還沒有評論哦！"))},qt=function(e){Rt();var t=e.onClose,n=e.open;return r.a.createElement(Ye.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",open:n,onClose:function(e){t(e)},fullWidth:!0,maxWidth:"sm"},r.a.createElement(It.a,{id:"simple-dialog-title",style:{backgroundColor:"#b7dcf9"}},"關於這個場地的評論"),r.a.createElement(Vt,{locationId:e.locationId,commentData:e.commentData}))},Kt={.5:"Useless",1:"Useless+",1.5:"Poor",2:"Poor+",2.5:"Ok",3:"Ok+",3.5:"Good",4:"Good+",4.5:"Excellent",5:"Excellent+"},Jt=function(e){var t=Lt(Object(a.useState)(-1),2),n=t[0],o=t[1],i=Rt();return r.a.createElement("div",{className:i.hoverRating},r.a.createElement(pt.a,{name:"hover-feedback",value:e.ratingVal,precision:.5,onChange:function(t,n){return e.updateRatingVal(n)},onChangeActive:function(e,t){o(t)}}),null!==e.ratingVal&&r.a.createElement(R.a,{ml:2,style:{fontSize:16}},Kt[-1!==n?n:e.ratingVal]))},$t=function(e){var t=Rt(),n=Lt(Object(a.useState)(0),2),o=n[0],i=n[1],l=Lt(Object(a.useState)({map_id:e.locationId,username:e.username,comment_title:"",comment:"",rating:0,create_dt:(new Date).toISOString(),update_dt:(new Date).toISOString()}),2),c=l[0],u=l[1],s=function(e){u(Mt(Mt({},c),{},zt({},e.target.name,e.target.value)))};return r.a.createElement(N.a,{container:!0,style:{marginTop:20,marginBottom:10}},r.a.createElement("form",{className:t.flexContainer,noValidate:!0,autoComplete:"off",margin:"normal",style:{width:"80%",marginRight:"auto",marginLeft:"auto"}},r.a.createElement(P.a,{onChange:s,size:"small",required:!0,id:"comment_title",name:"comment_title",label:"標題",variant:"filled"}),r.a.createElement(P.a,{onChange:s,size:"small",required:!0,id:"comment",name:"comment",label:"寫下你的心得吧...",variant:"filled",multiline:!0,rows:10}),r.a.createElement(Jt,{ratingVal:o,updateRatingVal:function(e){i(e)}}),r.a.createElement(z.a,{onClick:function(t){var n,a;t.preventDefault(),(n=c).rating=o,n.create_dt=new Date,n.update_dt=new Date,(a=n,p.post("guideMapComments/",a)).then((function(t){e.handleShowAlertOpen(),e.updateComments(n),e.onClose()})).then((function(){})).catch((function(e){console.error(e.response)})).finally((function(){}));var r={rating:e.countCommentRating(n.map_id)};h(n.map_id,r).then((function(t){e.updateMapDBByLocationId(n.map_id,r,"RATING")})).catch((function(e){console.error(e.response)})).finally((function(){}))},type:"submit",variant:"contained",color:"primary",style:{width:60,marginLeft:200,alignSelf:"flex-end"},className:t.submit},"送出")))},Yt=function(e){Rt();var t=e.onClose,n=e.open;return r.a.createElement(Ye.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",open:n,onClose:t,fullWidth:!0,maxWidth:"sm"},r.a.createElement(It.a,{id:"simple-dialog-title",style:{backgroundColor:"#b7dcf9"}},"我要寫評論"),r.a.createElement($t,{locationId:e.locationId,username:e.username,commentData:e.commentData,updateComments:e.updateComments,onClose:t,countCommentRating:e.countCommentRating,handleShowAlertOpen:e.handleShowAlertOpen}))},Ht=function(e){var t=Rt(),n=r.a.useContext(sa).state,o=Lt(Object(a.useState)("臺北市"),2),i=(o[0],o[1],Lt(Object(a.useState)("中正區"),2)),l=(i[0],i[1],Lt(Object(a.useState)({key:2,label:"全部"}),2)),c=(l[0],l[1],Lt(Object(a.useState)(0),2)),u=(c[0],c[1],Lt(Object(a.useState)(10),2)),s=(u[0],u[1],Lt(Object(a.useState)(null),2)),m=(s[0],s[1],Lt(Object(a.useState)(""),2)),d=(m[0],m[1],Lt(Object(a.useState)([]),2)),f=(d[0],d[1],Lt(Object(a.useState)([{key:0,label:"滑板場"},{key:1,label:"店家"}]),2)),g=(f[0],f[1],Lt(r.a.useState(!1),2)),y=g[0],v=g[1],E=function(){v(!0)},w=Lt(r.a.useState(!1),2),x=w[0],O=w[1],S=Lt(r.a.useState(!1),2),j=S[0],k=S[1],_=Lt(r.a.useState(0),2),D=_[0],I=_[1],A=Lt(r.a.useState(!1),2),T=A[0],P=A[1],F=Lt(r.a.useState(0),2),M=F[0],z=F[1],L=Lt(Object(a.useState)([]),2),W=L[0],U=L[1];Object(a.useEffect)((function(){p.get("guideMapComments/").then((function(e){U.apply(void 0,Nt(W).concat([e.data]))})).catch((function(e){console.error(e)})).finally((function(){}))}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(C,{open:y,onClose:function(){v(!1)}}),r.a.createElement(B,{open:x,onClose:function(){O(!1)}}),r.a.createElement(qt,{open:j,onClose:function(){k(!1)},locationId:D,commentData:W}),r.a.createElement(Yt,{open:T,onClose:function(){P(!1)},locationId:M,username:n.username,commentData:W,updateComments:function(e){U([].concat(Nt(W),[e]))},countCommentRating:function(e){console.log(W);var t=0,n=W.filter((function(t){return t.map_id==e}));for(var a in n)t+=Number(n[a].rating),console.log(n[a].rating);return console.log(Math.round(t/n.length*10)/10),Math.round(t/n.length*10)/10},handleShowAlertOpen:E}),r.a.createElement(G.a,{component:"main",maxWidth:"lg"},r.a.createElement("div",{className:t.root},r.a.createElement("div",{style:{width:"100%",marginBottom:50,marginTop:50}},r.a.createElement(gt.a,{title:"場地或店家列表",columns:[{title:"類型",field:"location_type",lookup:{"場地":"場地","店家":"店家"},width:100},{title:"場地名稱",field:"location_name",width:225},{title:"地址",field:"address"},{title:"綜合評分",field:"rating",width:220,render:function(e){return r.a.createElement(pt.a,{name:"hover-feedback",value:e.rating,readOnly:!0})}}],data:e.dbGuideMapData,actions:[function(e){return{icon:function(){return r.a.createElement(jt.a,null)},tooltip:"查看評論",onClick:function(e,t){return n=t.location_id,k(!0),void I(n);var n}}},function(e){return{icon:function(){return r.a.createElement(Ot.a,null)},tooltip:"發表評論",onClick:function(e,t){var n;n=t.location_id,P(!0),z(n)},disabled:!n.isAuthenticated}},function(t){return{icon:function(){return r.a.createElement(Gt.a,null)},tooltip:"加入最愛",onClick:function(t,a){!function(t,a){t.preventDefault(),console.log(a);var r=e.getMapDBByLocationId(a).like_user;null==r||null==r?r=[n.username]:r.push(n.username),h(a,{like_user:r}).then((function(t){e.updateMapDBByLocationId(a,r,"LIKE")})).catch((function(e){console.error(e.response)})).finally((function(){}));var o=e.userData.map_like;console.log(o),null==o?o=[a]:o.push(a);var i={map_like:o};b(n.username,i).then((function(t){console.table(t.data),e.updateGroupUserDB(i),E()})).catch((function(e){console.error(e.response)})).finally((function(){}))}(t,a.location_id)},disabled:!n.isAuthenticated||null!=t.like_user&&t.like_user.includes(n.username)}}],options:{filtering:!0,headerStyle:{backgroundColor:"#015da5",color:"#FFF",fontSize:16},actionsColumnIndex:-1},localization:{header:{actions:"評論/加入最愛"}},detailPanel:function(e){return r.a.createElement(N.a,{container:!0,style:{backgroundColor:"#e8f8fb"}},r.a.createElement(N.a,{item:!0,xs:12,sm:1}),r.a.createElement(N.a,{item:!0,xs:12,sm:4},r.a.createElement(R.a,{p:1},r.a.createElement(yt.a,null),"開放時間"),r.a.createElement(R.a,{p:1},r.a.createElement(_t.a,{primary:"平日: ".concat(e.openhours.weekdayTimeStart,"- ").concat(e.openhours.weekdayTimeEnd),classes:{primary:t.listItemText}}),r.a.createElement(_t.a,{primary:"假日與例假日: ".concat(e.openhours.weekendTimeStart,"- ").concat(e.openhours.weekendTimeEnd),classes:{primary:t.listItemText}}))),r.a.createElement(N.a,{item:!0,xs:12,sm:3},r.a.createElement(R.a,{p:1},r.a.createElement(vt.a,null),"建議交通方式"),r.a.createElement(R.a,{p:1},r.a.createElement(_t.a,{primary:"".concat(e.traffic),classes:{primary:t.listItemText}}))),r.a.createElement(N.a,{item:!0,xs:12,sm:4},r.a.createElement(R.a,{p:1},r.a.createElement(wt.a,null),"場地介紹"),r.a.createElement(R.a,{p:1},r.a.createElement(_t.a,{primary:"".concat(e.intro),classes:{primary:t.listItemText}}))))},onRowClick:function(e,t,n){return n()}})))))},Qt=(n.p,n.p,n.p,n(1136)),Xt=n(267),Zt=n.n(Xt);function en(e){return function(e){if(Array.isArray(e))return an(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||nn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(a=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(r)throw o}}return n}(e,t)||nn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nn(e,t){if(e){if("string"==typeof e)return an(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?an(e,t):void 0}}function an(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}r.a.useLayoutEffect=r.a.useEffect;var rn=Object(j.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)},"& .MuiTextField-root":{margin:e.spacing(1)},display:"flex",flexWrap:"wrap",listStyle:"none",padding:e.spacing(.5),margin:0},chip:{margin:e.spacing(.5)},modal:{display:"flex",alignItems:"center",justifyContent:"center"},flexContainer:{display:"flex",flexDirection:"row"},inlineContainer:{display:"inline"},paper:{backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)},button:{margin:10,paddingTop:20},card:{maxWidth:345},media:{height:0,paddingTop:"56.25%"},cardContent:{padding:10},cardAction:{padding:10},scrolltop:{position:"fixed",bottom:e.spacing(2),right:e.spacing(2)}}})),on=Object(Le.GoogleApiWrapper)({apiKey:"AIzaSyB7KldR4x33szhmh1Q8Vit9YynpWfvcOOs"})((function(e){r.a.useContext(sa).state;var t=rn(),n=tn(Object(a.useState)(!1),2),o=(n[0],n[1],tn(Object(a.useState)(0),2)),i=(o[0],o[1],tn(r.a.useState([{key:0,label:"滑板場"},{key:1,label:"店家"}]),2));i[0],i[1];Object(a.useEffect)((function(){localStorage.getItem("access_token"),localStorage.getItem("refresh_token")}),[]);var l=function(t){return e.dbFriendsGroupData.filter((function(e){return e.map_id==t})).length},c=tn(Object(a.useState)({activeMarker:{},selectedLocation:{},showingInfoWindow:!1}),2),u=c[0],s=c[1],m=function(e,t){return s({activeMarker:t,selectedLocation:e,showingInfoWindow:!0})},d=function(e){var t=e.children,n=rn();return r.a.createElement("div",{onClick:function(e){var t=(e.target.ownerDocument||document).querySelector("#back-to-top-anchor");t&&t.scrollIntoView({behavior:"smooth",block:"center"})},role:"presentation",className:n.scrolltop},t)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(G.a,{component:"main",maxWidth:"lg"},r.a.createElement(N.a,{container:!0,id:"back-to-top-anchor"},r.a.createElement("div",{className:t.flexContainer},r.a.createElement(dt,{updateDB:e.updateGuideMapDB,formerDbData:e.dbGuideMapData,userData:e.userData}),r.a.createElement("h3",{style:{marginLeft:30,marginBottom:20,marginTop:50}},r.a.createElement("span",{style:{verticalAlign:"middle"}},"場地"),r.a.createElement("img",{src:Bt.default,style:{height:32,verticalAlign:"middle"}}),r.a.createElement("span",{style:{marginLeft:20,verticalAlign:"middle"}},"店家"),r.a.createElement("img",{src:Tt,style:{height:32,verticalAlign:"middle"}}))))),r.a.createElement(N.a,{container:!0,style:{width:"80%",height:"60vh",textAlign:"center"}},r.a.createElement("div",null,r.a.createElement(Le.Map,{style:{height:"60vh"},className:"map",google:e.google,initialCenter:{lat:25.04,lng:121.51},onClick:function(){u.showingInfoWindow&&s({activeMarker:null,showingInfoWindow:!1})},zoom:13},e.dbGuideMapData.map((function(e,t){return"場地"===e.location_type?r.a.createElement(Le.Marker,{icon:{url:Bt.default,anchor:new google.maps.Point(32,32),scaledSize:new google.maps.Size(32,32)},key:t,name:e.location_name,address:e.address,groupCount:l(e.location_id),position:{lat:e.latitude,lng:e.longitude},onClick:m}):r.a.createElement(Le.Marker,{icon:{url:Tt,anchor:new google.maps.Point(32,32),scaledSize:new google.maps.Size(32,32)},key:t,name:e.location_name,address:e.address,groupCount:l(e.location_id),position:{lat:e.latitude,lng:e.longitude},onClick:m})})),r.a.createElement(Le.InfoWindow,{marker:u.activeMarker,onClose:function(){return s({activeMarker:null,showingInfoWindow:!1})},visible:u.showingInfoWindow},u.showingInfoWindow&&r.a.createElement(Re.a,{className:t.card},r.a.createElement(We.a,{className:t.cardContent},r.a.createElement(U.a,{variant:"h6",component:"h6"},u.selectedLocation.name),r.a.createElement(U.a,{variant:"body2",color:"textSecondary",component:"p"},r.a.createElement("a",{href:"https://www.google.com/maps/dir/?api=1&destination="+u.selectedLocation.address},u.selectedLocation.address))),r.a.createElement(Ue.a,{disableSpacing:!0,className:t.cardAction},r.a.createElement(U.a,{variant:"body2",color:"textSecondary",component:"p",style:{padding:10}},"目前揪團數：",u.selectedLocation.groupCount))))))),r.a.createElement(G.a,{component:"main",maxWidth:"lg"},r.a.createElement(N.a,{container:!0},r.a.createElement(Ht,{dbGuideMapData:e.dbGuideMapData,updateGuideMapDB:e.updateGuideMapDB,userData:e.userData,updateGroupUserDB:e.updateGroupUserDB,getMapDBByLocationId:function(t){return null!=e.dbGuideMapData?e.dbGuideMapData.find((function(e){return e.location_id===t})):null},updateMapDBByLocationId:function(t,n,a){var r=e.dbGuideMapData.findIndex((function(e){return e.location_id===t}));switch(console.log(n),console.log(t),a){case"RATING":e.dbGuideMapData[r].rating=n;break;case"LIKE":e.dbGuideMapData[r].like_user=n;break;default:console.log("none")}e.updateGuideMapDB.apply(e,en(e.dbGuideMapData))}}))),r.a.createElement(d,e,r.a.createElement(Qt.a,{color:"secondary",size:"small","aria-label":"scroll back to top"},r.a.createElement(Zt.a,null))))})),ln=(n(964),n(639)),cn=n.n(ln),un=n(442),sn=n.n(un),mn=n(569),dn=n(638),pn=n.n(dn);function fn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function gn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fn(Object(n),!0).forEach((function(t){En(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function bn(e){return function(e){if(Array.isArray(e))return vn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||hn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(a=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(r)throw o}}return n}(e,t)||hn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hn(e,t){if(e){if("string"==typeof e)return vn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vn(e,t):void 0}}function vn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function En(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var wn=Object(j.a)((function(e){return En({root:{"& > *":{margin:e.spacing(1)},"& .MuiTextField-root":{margin:e.spacing(1)}},modal:{display:"flex",alignItems:"center",justifyContent:"center"},flexContainer:{display:"flex",flexDirection:"row"},paper:{backgroundColor:e.palette.background.paper,boxShadow:e.shadows[5],padding:e.spacing(2,4,3),paddingBottom:20},button:{padding:20,margin:40},card:{maxWidth:345},media:{height:0,paddingTop:"56.25%"},chips:{display:"flex",flexWrap:"wrap"},chip:{margin:2},buttonAdd:{margin:e.spacing(1)}},"button",{margin:e.spacing(1)})})),xn=function(e){var t=wn();return null!=e.commentData&&e.commentData.some((function(t){return t.group_id==e.groupId}))?r.a.createElement(Dt.a,{className:t.root},e.commentData.map((function(t,n){if(t.group_id==e.groupId)return null==t.create_dt&&(console.log(t.create_dt),t.create_dt=(new Date).toISOString(),console.log(t.create_dt)),r.a.createElement(r.a.Fragment,null,r.a.createElement(Ct.a,{alignItems:"flex-start",key:n},r.a.createElement(_t.a,{key:t.group_id,primary:r.a.createElement(r.a.Fragment,{key:t.group_id+"group"},r.a.createElement("div",{style:{color:"#0198e3"}},r.a.createElement(pn.a,null),"".concat(t.comment_user)),r.a.createElement("div",null,t.comment))}),r.a.createElement("span",{style:{fontSize:12,color:"#9a9898",alignItems:"left"}},t.create_dt.toString())))}))):r.a.createElement("span",null,"目前還沒有留言哦！")},On=function(e){wn();var t=Object(c.h)().id,n=r.a.useContext(sa).state,o=yn(Object(a.useState)([]),2),i=o[0],l=o[1],u=yn(Object(a.useState)([]),2),s=u[0],m=u[1],p=yn(Object(a.useState)({group_id:t,comment_user:n.username,comment:"",create_dt:(new Date).toISOString(),update_dt:(new Date).toISOString()}),2),f=p[0],g=p[1];Object(a.useEffect)((function(){v().then((function(e){m.apply(void 0,bn(s).concat([e.data]))})).catch((function(e){console.error(e)})).finally((function(){}))}),[]),Object(a.useEffect)((function(){w().then((function(e){l.apply(void 0,bn(i).concat([e.data]))})).catch((function(e){console.error(e.response)})).finally((function(){}))}),[]);var b=yn(r.a.useState(!1),2),y=b[0],h=b[1],E=yn(r.a.useState(!1),2),x=E[0],O=E[1],S=function(e){g(gn(gn({},f),{},En({},e.target.name,e.target.value)))},j=function(e){e.preventDefault();var t,n={};(n=f).create_dt=new Date,n.update_dt=new Date,console.log(n),(t=n,d.post("friendsGroupComments/",t)).then((function(e){h(!0),l([].concat(bn(i),[n])),console.log(i)})).catch((function(e){console.error(e.response)})).finally((function(){}))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(C,{open:y,onClose:function(){h(!1)}}),r.a.createElement(B,{open:x,onClose:function(){O(!1)}}),r.a.createElement("div",null,s.map((function(e,n){if(e.group_id==t)return r.a.createElement(G.a,{component:"main",maxWidth:"md",style:{marginTop:70}},r.a.createElement(N.a,{Container:!0},r.a.createElement("div",{style:{marginTop:70,marginBottom:30}},r.a.createElement("span",{style:{fontSize:24,fontWeight:"bold"}},"".concat(e.group_startdt.slice(0,10),"    ")," "),r.a.createElement("span",{style:{fontSize:20,fontWeight:"bold"}},"".concat(e.group_startdt.slice(11,19),"    ")),r.a.createElement("span",{style:{fontSize:22,fontWeight:"bold"}},e.location_name),r.a.createElement("span",{style:{textAlign:"left"}}," ","(ID：",e.group_id,")"),r.a.createElement("span",{style:{marginLeft:100}},"建立者：".concat(e.create_user))),r.a.createElement(Ct.a,null,r.a.createElement(_t.a,null,"地址：",r.a.createElement("a",{href:"https://www.google.com/maps/dir/?api=1&destination="+e.address},"".concat(e.address)))),r.a.createElement(Ct.a,null,r.a.createElement(_t.a,null,r.a.createElement("span",null,"     人數上下限：".concat(e.lower_limit,"人 - ").concat(e.upper_limit,"人")))),r.a.createElement(Ct.a,null,r.a.createElement(_t.a,null,"內容：".concat(e.group_content))),r.a.createElement(Ct.a,null,r.a.createElement(_t.a,null,"參加名單：".concat(e.join_user))),r.a.createElement(Ct.a,null,r.a.createElement(_t.a,null,"追蹤名單：".concat(e.possible_user))),r.a.createElement(Ct.a,null,r.a.createElement("span",{style:{fontSize:12,color:"#9a9898",alignItems:"left",marginRight:10}},"新增日期：".concat(e.create_dt.slice(0,10),"  ").concat(e.create_dt.slice(11,19))),r.a.createElement("span",{style:{fontSize:12,color:"#9a9898",alignItems:"left"}},"更新日期：".concat(e.update_dt.slice(0,10),"  ").concat(e.update_dt.slice(11,19))))),r.a.createElement("div",{style:{display:"flex",alignItems:"center",marginTop:50}},r.a.createElement(P.a,{onChange:S,size:"small",id:"comment",name:"comment",label:"我有問題",variant:"filled",style:{width:300,marginRight:20}}),r.a.createElement(z.a,{style:{height:40},onClick:j,variant:"contained",color:"secondary",endIcon:r.a.createElement(mn.a,null,"send")},"送出留言")),r.a.createElement(N.a,{Container:!0,style:{backgroundColor:"#fff",marginBottom:50,marginTop:40}},r.a.createElement(xn,{groupId:t,commentData:i})))}))))};function Sn(e){return function(e){if(Array.isArray(e))return _n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||kn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(a=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(r)throw o}}return n}(e,t)||kn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kn(e,t){if(e){if("string"==typeof e)return _n(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_n(e,t):void 0}}function _n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Dn=Object(j.a)((function(e){return t={root:{"& > *":{margin:e.spacing(1)},"& .MuiTextField-root":{margin:e.spacing(1)}},modal:{display:"flex",alignItems:"center",justifyContent:"center"},flexContainer:{display:"flex",flexDirection:"row"},paper:{backgroundColor:e.palette.background.paper,boxShadow:e.shadows[5],padding:e.spacing(2,4,3),paddingBottom:20},button:{margin:10,paddingTop:20},card:{maxWidth:345},media:{height:0,paddingTop:"56.25%"},chips:{display:"flex",flexWrap:"wrap"},chip:{margin:2},buttonAdd:{margin:e.spacing(1)}},n="button",a={margin:e.spacing(1)},n in t?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a,t;var t,n,a})),Cn=function(e){console.log(e);var t=Dn(),n=r.a.useContext(sa).state,o=jn(Object(a.useState)([]),2),i=o[0],c=o[1];Object(a.useEffect)((function(){w().then((function(e){c.apply(void 0,Sn(i).concat([e.data]))})).catch((function(e){console.error(e.response)})).finally((function(){}))}),[]);var u=jn(r.a.useState(!1),2),s=u[0],m=u[1],d=function(){m(!0)},p=jn(r.a.useState(!1),2),f=p[0],g=p[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(C,{open:s,onClose:function(){m(!1)}}),r.a.createElement(B,{open:f,onClose:function(){g(!1)}}),r.a.createElement(G.a,{component:"main",maxWidth:"lg"},r.a.createElement("div",{className:t.root},r.a.createElement("div",{style:{width:"100%",marginBottom:50,marginTop:10}},r.a.createElement(gt.a,{title:"開團列表",columns:[{title:"ID",field:"group_id",width:25},{title:"類型",field:"group_type",lookup:{"交流":"交流","教學":"教學"},width:90},{title:"地點",field:"location_name",width:120},{title:"時間",field:"group_startdt",width:70},{title:"主題",field:"group_title",width:270},{title:"剩餘名額",field:"remain_count",width:100},{title:"參加人數",field:"join_count",width:100}],data:e.dbFriendsGroupData,actions:[function(e){return{icon:function(){return r.a.createElement(l.c,{to:"friendsGroupDetail/".concat(e.group_id),key:e.group_id,style:{color:"black"}},r.a.createElement(sn.a,null))},tooltip:"查看內容"}},function(t){return{icon:function(){return r.a.createElement(cn.a,null)},tooltip:"參加",onClick:function(t,a){!function(t,a){t.preventDefault();var r=e.getFriendsGroupDBById(a).join_user;null==r||null==r?r=[n.username]:r.push(n.username),E(a,{join_user:r}).then((function(t){e.updateFriendsGroupDBById(a,r,"JOIN")})).catch((function(e){console.error(e.response)})).finally((function(){}));var o=e.userData.group_join;null==o?o=[a]:o.push(a);var i={group_join:o};b(n.username,i).then((function(t){console.table(t.data),e.updateGroupUserDB(i),d()})).catch((function(e){console.error(e.response)})).finally((function(){}))}(t,a.group_id)},disabled:!n.isAuthenticated||null==t.join_user||t.join_user.includes(n.username)}},function(t){return{icon:function(){return r.a.createElement(Gt.a,null)},tooltip:"追蹤",onClick:function(t,a){!function(t,a){t.preventDefault();var r=e.getFriendsGroupDBById(a).possible_user;null==r||null==r?r=[n.username]:r.push(n.username),E(a,{possible_user:r}).then((function(t){e.updateFriendsGroupDBById(a,r,"LIKE")})).catch((function(e){console.error(e.response)})).finally((function(){}));var o=e.userData.group_like;null==o?o=[a]:o.push(a);var i={group_like:o};b(n.username,i).then((function(t){console.table(t.data),e.updateGroupUserDB(i),d()})).catch((function(e){console.error(e.response)})).finally((function(){}))}(t,a.group_id)},disabled:!n.isAuthenticated||null==t.possible_user||t.possible_user.includes(n.username)}}],options:{filtering:!0,headerStyle:{backgroundColor:"#015da5",color:"#FFF",fontSize:16},actionsColumnIndex:-1,pageSize:10},localization:{header:{actions:["詳細內容/ ","參加/ ","追蹤"]}}})))))},In=n(640),An=n.n(In),Tn=(n(965),n(621)),Bn=n(1143),Pn=n(1139);function Gn(){return(Gn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Fn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nn(Object(n),!0).forEach((function(t){Mn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Mn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zn(e){return function(e){if(Array.isArray(e))return Un(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Wn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ln(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(a=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(r)throw o}}return n}(e,t)||Wn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wn(e,t){if(e){if("string"==typeof e)return Un(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Un(e,t):void 0}}function Un(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Rn=Object(j.a)((function(e){return{root:{"& .MuiTextField-root":{margin:e.spacing(1),width:"25ch"},flexContainer:{display:"flex",flexDirection:"row"},paper:{backgroundColor:e.palette.background.paper,boxShadow:e.shadows[5],padding:e.spacing(2,4,3),paddingBottom:20},datetime:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1)},formControl:{margin:e.spacing(1),paddingBottom:20}}}})),Vn=Object(me.a)((function(e){}));Object.assign(Vn,{overrides:{MUIRichTextEditor:{root:{backgroundColor:"#ebebeb"},container:{display:"flex",flexDirection:"column"},editor:{backgroundColor:"#ebebeb",padding:"20px",height:"200px",maxHeight:"200px",overflow:"auto"},toolbar:{backgroundColor:"#ebebeb"},placeHolder:{backgroundColor:"#ebebeb",paddingLeft:20,width:"inherit",position:"absolute",top:"60px"},anchorLink:{color:"#333333",textDecoration:"underline"}}}});var qn=function(e){var t=r.a.useContext(sa).state,n=Rn(),o=Ln(Object(a.useState)({map_id:1,group_startdt:(new Date).toISOString(),group_enddt:(new Date).toISOString(),location_name:"",latitude:0,longitude:0,address:"",group_type:"交流",group_title:"",group_content:"",create_user:t.username,join_user:[],possible_user:[],create_dt:(new Date).toISOString(),update_dt:(new Date).toISOString(),lower_limit:0,upper_limit:0}),2),i=o[0],l=o[1],u=Ln(Object(a.useState)([]),2),s=u[0],m=u[1];Object(a.useEffect)((function(){y().then((function(e){m.apply(void 0,zn(s).concat([e.data]))})).catch((function(e){console.error(e.response)})).finally((function(){}))}),[]);var p=function(e){"group_startdt"==e.target.name||"group_enddt"==e.target.name?l(Fn(Fn({},i),{},Mn({},e.target.name,e.target.value.toLocaleString().replace("T"," ")))):l(Fn(Fn({},i),{},Mn({},e.target.name,e.target.value)))},f=Ln(Object(a.useState)(""),2),g=(f[0],f[1],Ln(Object(a.useState)(!1),2)),b=g[0],h=g[1],v=Ln(Object(a.useState)(!0),2),E=(v[0],v[1]),w=Ln(Object(a.useState)([]),2),x=w[0],O=w[1],j=Ln(r.a.useState(!1),2),k=j[0],_=j[1],D=Ln(r.a.useState(!1),2),I=D[0],A=D[1],T=Ln(r.a.useState(!1),2),G=T[0],F=T[1],M=Ln(r.a.useState(""),2);M[0],M[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(C,{open:k,onClose:function(){_(!1)}}),r.a.createElement(B,{open:I,onClose:function(){A(!1)}}),r.a.createElement(N.a,{container:!0,style:{marginTop:20,marginBottom:10}},r.a.createElement(Ye.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:n.modal,open:b,onClose:function(){h(!1)},closeAfterTransition:!0,BackdropComponent:Ve.a,BackdropProps:{timeout:500}},r.a.createElement(qe.a,{in:b},r.a.createElement(S.a,{severity:"error"},r.a.createElement(Pn.a,null,"以下資料不可為空！"),r.a.createElement("span",null,x.join(", "))))),r.a.createElement(N.a,{item:!0,xs:6,style:{marginLeft:100}},r.a.createElement("form",{className:n.formControl,noValidate:!0,autoComplete:"off"},r.a.createElement("h2",null,"填寫開團資訊"),r.a.createElement("div",{className:n.paper},r.a.createElement(Ze.a,{className:n.formControl},r.a.createElement(P.a,{disabled:!0,defaultValue:t.username,id:"create_user",name:"create_user",label:"建立者",variant:"filled",className:n.textField,style:{width:250}}),r.a.createElement(Ze.a,{component:"fieldset"},r.a.createElement(Qe.a,{onChange:p,row:!0,"aria-label":"group_type",name:"group_type",value:i.group_type,style:{marginTop:20}},r.a.createElement(Xe.a,{value:"交流",control:r.a.createElement(He.a,null),label:"交流"}),r.a.createElement(Xe.a,{value:"教學",control:r.a.createElement(He.a,null),label:"教學"}))),r.a.createElement(Ze.a,null,r.a.createElement("div",{className:n.flexContainer,style:{marginBottom:20}},r.a.createElement("span",{style:{fontSize:16,display:"block"}},"開團時間"),r.a.createElement(P.a,{required:!0,onChange:p,id:"datetime-local",name:"group_startdt",label:"開始",type:"datetime-local",className:n.textField,InputLabelProps:{shrink:!0},style:{marginTop:20}}),r.a.createElement(P.a,{required:!0,onChange:p,id:"datetime-local",name:"group_enddt",label:"結束",type:"datetime-local",className:n.textField,InputLabelProps:{shrink:!0},style:{marginTop:20}}))),!G&&r.a.createElement(Bn.a,Mn({className:n.textField,id:"combo-box-demo",onChange:function(e,t){l(Fn(Fn({},i),{},{location_name:t.location_name}))},name:"location_name",options:s,getOptionLabel:function(e){return e.location_name},style:{width:300},renderInput:function(e){return r.a.createElement(P.a,Gn({},e,{label:"場地名稱",variant:"outlined"}))}},"style",{width:500,marginBottom:20})),r.a.createElement(Xe.a,{control:r.a.createElement(Tn.a,{checked:G,onChange:function(e){F(e.target.checked)},color:"primary",inputProps:{"aria-label":"secondary checkbox"}}),label:"沒有在上面？自行輸入"}),G&&r.a.createElement(r.a.Fragment,null,r.a.createElement(P.a,{onChange:p,size:"small",id:"location_name",name:"location_name",label:"場地名稱",variant:"filled",fullWidth:!0,style:{marginTop:20}}),r.a.createElement(P.a,{onChange:p,size:"small",id:"address",name:"address",label:"地址",variant:"filled",fullWidth:!0,style:{marginTop:20}})),r.a.createElement("div",{className:n.flexContainer},r.a.createElement(P.a,{required:!0,id:"lower_limit",label:"人數下限",type:"number",InputLabelProps:{shrink:!0},variant:"filled",style:{marginTop:20,marginRight:20}}),r.a.createElement(P.a,{required:!0,id:"uppper_limit",label:"人數上限",type:"number",InputLabelProps:{shrink:!0},variant:"filled",style:{marginTop:20}})),r.a.createElement(P.a,{onChange:p,required:!0,id:"group_title",name:"group_title",label:"主題",variant:"filled",fullWidth:!0,style:{marginTop:20}}),r.a.createElement("h3",null,"內容"),r.a.createElement(P.a,{required:!0,onChange:p,id:"filled-multiline-static",label:"填寫相關內容",name:"group_content",multiline:!0,fullWidth:!0,rows:8,value:i.group_content,variant:"filled"}),r.a.createElement(z.a,{onClick:function(e){if(e.preventDefault(),function(){var e=[];if(O({errorFields:[]}),i.location_name||(e.push("場地名稱"),E(!1)),i.group_title||e.push("主題"),i.group_startdt||e.push("開始日期"),i.group_enddt||e.push("結束日期"),!i.group_content)return e.push("內容"),O([].concat(zn(x),[e])),h(!0),!1}()){if(""==i.address){var n=(a=r.location_name,s.find((function(e){return e.location_name==a})));i.address=n.address,i.map_id=n.map_id}var a,r=i;r.create_user=t.username,r.create_dt=new Date,r.update_dt=new Date,ot.a.setApiKey("AIzaSyB7KldR4x33szhmh1Q8Vit9YynpWfvcOOs"),ot.a.enableDebug(),ot.a.fromAddress(i.address).then((function(e){var t=e.results[0].geometry.location,n=t.lat,a=t.lng;l({latitude:n,longitude:a}),r.latitude=n,r.longitude=a}),(function(e){console.error(e)})).then((function(){var e;(e=r,d.post("friendsGroup/",e)).then((function(e){setDbFriendsGroupData([].concat(zn(dbFriendsGroupData),[r])),_(!0)})).catch((function(e){console.error(e.response)})).finally((function(){c.a}))}))}},type:"submit",variant:"contained",color:"primary",className:n.submit,style:{marginTop:20,width:150,marginBottom:70}},"確認修改"))))),r.a.createElement(N.a,{item:!0,xs:!0},r.a.createElement("div",null,r.a.createElement("img",{src:ee,style:{height:700,width:"auto",marginTop:150,marginBottom:70},alt:"banner"})))))},Kn=Object(j.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)},"& .MuiTextField-root":{margin:e.spacing(1)}},modal:{display:"flex",alignItems:"center",justifyContent:"center"},buttonAdd:{margin:e.spacing(1),marginBottom:20,marginTop:50}}})),Jn=function(e){var t=Kn();r.a.useContext(sa).state;return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.b,{to:{pathname:"/friendsGroup/create",state:{dbFriendsGroupData:e.dbFriendsGroupData}},className:"link"},r.a.createElement(z.a,{variant:"contained",color:"secondary",className:t.buttonAdd,startIcon:r.a.createElement(An.a,null)},"我要揪團")))};function $n(e){return function(e){if(Array.isArray(e))return Yn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Yn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yn(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Hn=Object(j.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)},"& .MuiTextField-root":{margin:e.spacing(1)}},modal:{display:"flex",alignItems:"center",justifyContent:"center"},buttonAdd:{margin:e.spacing(1)},scrolltop:{position:"fixed",bottom:e.spacing(2),right:e.spacing(2)}}})),Qn=function(e){r.a.useContext(sa).state;Object(a.useEffect)((function(){localStorage.getItem("access_token"),localStorage.getItem("refresh_token")}),[]);Object(a.useEffect)((function(){v().then((function(t){e.updateFriendsGroupDB.apply(e,$n(e.dbFriendsGroupData).concat([t.data]))})).catch((function(e){console.error(e)})).finally((function(){}))}),[]),null==e.dbFriendsGroupData&&null==e.dbFriendsGroupData||e.dbFriendsGroupData.map((function(e,t){null==e.join_user&&null==e.join_user&&null==e.possible_user&&null==e.possible_user&&null==e.upper_limit&&null==e.upper_limit||(e.join_count=e.join_user.length,0===e.upper_limit?e.remain_count=999:e.remain_count=e.upper_limit-e.join_user.length)}));var t=function(e){var t=e.children,n=Hn();return r.a.createElement("div",{onClick:function(e){var t=(e.target.ownerDocument||document).querySelector("#back-to-top-anchor");t&&t.scrollIntoView({behavior:"smooth",block:"center"})},role:"presentation",className:n.scrolltop},t)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(G.a,{component:"main",maxWidth:"lg",style:{textAlign:"center"},className:"user_conatainer"},r.a.createElement(N.a,{container:!0,id:"back-to-top-anchor"},r.a.createElement(Jn,{dbFriendsGroupData:e.dbFriendsGroupData})),r.a.createElement(N.a,{container:!0},r.a.createElement(Cn,{dbFriendsGroupData:e.dbFriendsGroupData,updateFriendsGroupDB:e.updateFriendsGroupDB,updateFriendsGroupDBById:function(t,n,a){var r=e.dbFriendsGroupData.findIndex((function(e){return e.group_id===t}));switch(a){case"JOIN":e.dbFriendsGroupData[r].join_user=n;break;case"LIKE":e.dbFriendsGroupData[r].possible_user=n;break;default:console.log("none")}e.updateFriendsGroupDB($n(e.dbFriendsGroupData))},getFriendsGroupDBById:function(t){return null!=e.dbFriendsGroupData?e.dbFriendsGroupData.find((function(e){return e.group_id===t})):null},userData:e.userData,updateUserDB:e.updateUserDB,updateGroupUserDB:e.updateGroupUserDB}))),r.a.createElement(t,e,r.a.createElement(Qt.a,{color:"secondary",size:"small","aria-label":"scroll back to top"},r.a.createElement(Zt.a,null))))},Xn=(n(1085),n.p+"4beb47802af8c92baa1e3d97cd5bef20.png"),Zn=n(448),ea=n.n(Zn),ta=n(641),na=n.n(ta);function aa(e){return function(e){if(Array.isArray(e))return ia(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||oa(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ra(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(a=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(r)throw o}}return n}(e,t)||oa(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oa(e,t){if(e){if("string"==typeof e)return ia(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ia(e,t):void 0}}function ia(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function la(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ca(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?la(Object(n),!0).forEach((function(t){ua(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):la(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ua(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var sa=r.a.createContext(),ma={isAuthenticated:!1,access:null,refresh:null,username:null},da=function(e,t){switch(t.type){case"LOGIN":return null==t.payload.data?(console.log(e),ca(ca({},e),{},{isAuthenticated:!0,access:localStorage.getItem("access_token"),refresh:localStorage.getItem("refresh_token"),username:localStorage.getItem("username")})):(console.log(t),ca(ca({},e),{},{isAuthenticated:!0,access:t.payload.data.access,refresh:t.payload.data.refresh,username:JSON.parse(t.payload.config.data).username}));case"LOGOUT":return ca(ca({},e),{},{isAuthenticated:!1,access:null,refresh:null});case"UPDATE":return ca(ca({},e),{},{isAuthenticated:!0});default:return e}},pa=Object(j.a)((function(e){return{link:{paddingTop:10,paddingBottom:10,paddingRight:10,paddingLeft:10,"&:hover":{background:"#c6f0a6",paddingTop:10,paddingBottom:10,paddingRight:10,paddingLeft:10,borderRadius:10},color:"#CA3900",fontWeight:600,fontSize:24,textDecoration:"none",backgroundSize:"cover"},activelink:{background:"#c6f0a6",paddingTop:10,paddingBottom:10,paddingRight:10,paddingLeft:10,borderRadius:10}}})),fa=function(){var e=pa(),t=ra(r.a.useReducer(da,ma),2),n=t[0],o=t[1],i=Object(c.g)(),u=ra(r.a.useState(0),2),s=(u[0],u[1],ra(Object(a.useState)({location:"",nickname:"",intro:"",email:"",map_like:[],map_add:[],map_comment:[],group_create:[],group_join:[],group_like:[]}),2)),d=s[0],p=s[1],f=function(e){p(e),console.log(e)},g=function(e){p(ca(ca({},d),{},ua({},e.name,e.value)))},b=function(e){p(ca(ca({},d),{},{newValue:e}))},h=ra(Object(a.useState)([]),2),E=h[0],w=h[1],O=function(e){w([].concat(aa(E),[e]))},S=ra(Object(a.useState)([]),2),j=S[0],k=S[1],_=function(e){k([].concat(aa(j),[e]))};return Object(a.useEffect)((function(){var e=localStorage.getItem("access_token")||null,t=localStorage.getItem("refresh_token")||null,n=localStorage.getItem("username")||null;e&&t&&o({type:"LOGIN",payload:{access:e,refresh:t,username:n}})}),[]),Object(a.useEffect)((function(){y().then((function(e){k.apply(void 0,aa(j).concat([e.data]))})).catch((function(e){console.error(e)})).finally((function(){}))}),[]),Object(a.useEffect)((function(){v().then((function(e){for(var t in e.data)e.data[t].group_startdt="".concat(e.data[t].group_startdt.slice(0,10),"  ").concat(e.data[t].group_startdt.slice(11,19));w.apply(void 0,aa(E).concat([e.data]))})).catch((function(e){console.error(e.response)})).finally((function(){}))}),[]),r.a.createElement(sa.Provider,{value:{state:n,dispatch:o}},r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"logo"},r.a.createElement(l.b,{to:"/",className:"link"},r.a.createElement("img",{src:Xn,alt:"logo"})),r.a.createElement(l.b,{to:"/",className:"link"},r.a.createElement("span",{style:{marginLeft:20,fontFamily:"Galindo",marginTop:"auto",marginBottom:"auto",fontSize:28,fontWeight:900}},"SkateboardGO"))),r.a.createElement("div",{className:"nav"},r.a.createElement("ul",{className:"nav-link"},r.a.createElement("li",{className:"nav-link-item"},r.a.createElement(l.c,{to:"/guidemap",activeClassName:e.activelink,className:e.link},r.a.createElement(ea.a,{style:{verticalAlign:"middle"}}),r.a.createElement("span",{style:{verticalAlign:"middle"}},"地圖"))),r.a.createElement("li",{className:"nav-link-item"},r.a.createElement(l.c,{to:"/friendsgroup",activeClassName:e.activelink,className:e.link},r.a.createElement(na.a,{style:{verticalAlign:"middle"}}),r.a.createElement("span",{style:{verticalAlign:"middle"}},"揪團"))),n.isAuthenticated&&r.a.createElement("li",{className:"nav-link-item"},r.a.createElement(l.c,{to:"/user",activeClassName:e.activelink,className:e.link},r.a.createElement(ea.a,{style:{verticalAlign:"middle"}}),r.a.createElement("span",{style:{verticalAlign:"middle"}},"會員中心"))),n.isAuthenticated?r.a.createElement("li",{className:"nav-link-btn"},r.a.createElement(z.a,{onClick:function(){var e;(e={refresh_token:localStorage.getItem("refresh_token")},m.post("/blacklist/",e)).then((function(){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),x.defaults.headers.Authorization=null})).then((function(){o({type:"LOGOUT"})})).then((function(){i.push("/")})).catch((function(e){console.log(e.response)}))},variant:"contained",style:{backgroundColor:"#f95173"}},"登出")):r.a.createElement("li",{className:"nav-link-btn"},r.a.createElement(l.b,{to:"/login/",className:"link"},r.a.createElement(z.a,{variant:"contained",style:{backgroundColor:"#188af2",color:"white"}},"登入"))),!n.isAuthenticated&&r.a.createElement("li",{className:"nav-link-btn"},r.a.createElement(l.b,{to:"/signup/",className:"link"},r.a.createElement(z.a,{variant:"contained",color:"primary"},"註冊")))))),r.a.createElement(c.d,null,r.a.createElement(c.b,{exact:!0,path:"/",render:function(){return r.a.createElement(ze,null)}}),r.a.createElement(c.b,{exact:!0,path:"/guidemap",key:"route-guidemap",render:function(){return r.a.createElement(on,{userData:d,updateUserDB:g,dbGuideMapData:j,updateGuideMapDB:_,dbFriendsGroupData:E,updateGroupUserDB:b})}}),r.a.createElement(c.b,{exact:!0,path:"/friendsgroup",key:"route-friendsgroup",render:function(){return r.a.createElement(Qn,{userData:d,updateUserDB:g,updateGroupUserDB:b,dbFriendsGroupData:E,updateFriendsGroupDB:O})}}),r.a.createElement(c.b,{exact:!0,path:"/user",key:"route-user",render:function(){return r.a.createElement(ie,{userData:d,updateUserDB:g,initUserDB:f,dbFriendsGroupData:E,dbGuideMapData:j})}}),r.a.createElement(c.b,{exact:!0,path:"/friendsGroup/create",key:"route-friendsGroupCreate",render:function(){return r.a.createElement(qn,{userData:d,updateUserDB:g})}}),r.a.createElement(c.b,{exact:!0,path:"/friendsGroupDetail/:id",key:"route-friendsGroupDetail",render:function(){return r.a.createElement(On,null)}}),r.a.createElement(c.b,{exact:!0,path:"/login/",render:function(){return r.a.createElement(Ge,{userData:d,initUserDB:f})}}),r.a.createElement(c.b,{exact:!0,path:"/signup/",component:Se})),r.a.createElement("div",{className:"footer"},r.a.createElement("div",null,"Frontend: ReactJS, Material-UI"),r.a.createElement("div",null,"Backend: Django(Python), PosgreSQL"),r.a.createElement("div",null,"Designed by Sandy Lin, 2020")))};i.a.render(r.a.createElement(l.a,null,r.a.createElement(fa,null)),document.getElementById("root"))},203:function(e,t,n){var a=n(875),r=n(876);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1};a(r,o);e.exports=r.locals||{}},265:function(e,t,n){"use strict";n.r(t),t.default=n.p+"ee61c65bcecbd9ad9c715262a30527e8.png"},649:function(e,t,n){n(650),e.exports=n(1086)},876:function(e,t,n){var a=n(877),r=n(878),o=n(265);t=a(!1);var i=r(o);t.push([e.i,"body {\n  width: 100%;\n  /* height: 100%; */\n  margin: 0 auto;\n  font-family: sans-serif;\n  /* background-color: black; */\n  background-color: #fcf3ea;\n  color: #2e2d2d;\n  /* font-size: 20px; */\n}\n\n\n.footer {\n  background-color: #2e2d2d;\n  font-size: 16px;\n  color: #fcf3ea;\n  text-align: center;\n  /* margin-top: 100px; */\n  padding-top: 60px; \n  bottom: 0;\n  height: 150px;\n  z-index: 2;\n  /* margin-top:calc(5% + 60px); */\n}\n\n.footer div{\n  margin-bottom: 10px;\n}\n\n.user_conatainer {\n  min-height: calc(100vh - 150px);\n}\n\n.wrapper{\n  min-height: 100%;\n}\n\n\n#background {\n  position: fixed;\n  top: 0px;\n  left: 0px;\n  width: 50%;\n  height: 100%;\n  background-color: #fcf3ea;\n  z-index: 1;\n}\n\n.circle {\n  width: 200px;\n  height: 200px;\n  border-radius: 50%;\n  font-size: 50px;\n  color: #fff;\n  line-height: 200px;\n  text-align: center;\n  background: #000;\n  align-items: center;\n}\n.circle2 {\n  width: 200px;\n  height: 200px;\n  border-radius: 50%;\n  font-size: 50px;\n  color: black;\n  line-height: 200px;\n  text-align: center;\n  background: #fff;\n}\n\n.logo {\n  margin: 30px auto auto 30px;\n  width: 70px;\n  display: flex;\n  z-index: 2;\n}\n\n.logo img {\n  height: 48px;\n  width: auto;\n}\n.banner_conatainer {\n  width: 100%;\n  height: 100%;\n}\n\n\n\n.lefttoright {\n  width: 100%;\n  position: relative;\n  -webkit-animation: floatBubble 0.6s 1s normal ease-out forwards;\n  animation: floatBubble 0.6s 1s normal ease-out forwards;\n  /* -webkit-animation:spin 5000ms linear 1s;\n  -moz-animation:spin 5000ms linear 1s;\n  animation:spin 5000ms linear 1s; */\n}\n.spin {\n  -webkit-animation: spin 1s linear 1s;\n  -moz-animation: spin 1s linear 1s;\n  animation: spin 1s linear 1s;\n}\n\n@-moz-keyframes spin {\n  100% {\n    -moz-transform: rotate(360deg);\n  }\n}\n@-webkit-keyframes spin {\n  100% {\n    -webkit-transform: rotate(360deg);\n  }\n}\n@keyframes spin {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n\n.header {\n  display: flex;\n  background-color: #F3D250;\n}\n.nav {\n  flex: auto;\n  display: flex;\n  font-size: 18px;\n  justify-content: flex-end;\n}\n\n.nav-link {\n  list-style: none;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin-right: 40px;\n}\n\n.nav-link-item {\n  display: flex;\n  flex-direction: row;\n  padding-top: 0.5rem;\n  padding-bottom: 0.5rem;\n  pointer-events: auto;\n  margin-left: 30px;\n  margin-right: 30px;\n}\n\n.nav-link-btn {\n  flex: none;\n  padding-top: 0.5rem;\n  padding-bottom: 0.5rem;\n  pointer-events: auto;\n  margin-left: 10px;\n  margin-right: 10px;\n}\n\n.link {\n  /* color:#F76C6C; */\n  font-weight: 600;\n  font-size: 20px;\n  text-decoration: none;\n  align-items: center;\n}\n\n.link:visited{\n  color: black\n}\n\n.userLink {\n  color:#F76C6C;\n  font-weight: 600;\n  font-size: 20px;\n  text-decoration: none;\n  align-items: center;\n}\n\n.userLink:visited{\n  color: #F76C6C\n}\n\n.loginform {\n  width: 390px;\n  background: #fff;\n  border-radius: 10px;\n  overflow: hidden;\n  padding: 77px 55px 33px 55px;\n\n  box-shadow: 0 5px 10px 0px rgba(0, 0, 0, 0.1);\n  -moz-box-shadow: 0 5px 10px 0px rgba(0, 0, 0, 0.1);\n  -webkit-box-shadow: 0 5px 10px 0px rgba(0, 0, 0, 0.1);\n  -o-box-shadow: 0 5px 10px 0px rgba(0, 0, 0, 0.1);\n  -ms-box-shadow: 0 5px 10px 0px rgba(0, 0, 0, 0.1);\n}\n\n.login_container {\n  width: 100%;\n  min-height: 100vh;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -moz-box;\n  display: -ms-flexbox;\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  align-items: center;\n  padding: 15px;\n  background: #fcf3ea;\n}\n\ninput {\n  outline: none;\n  border: none;\n}\n\n.form_input_wrap {\n  width: 100%;\n  position: relative;\n  border-bottom: 2px solid #adadad;\n  margin-bottom: 37px;\n}\n\n.form_input {\n  font-family: Poppins-Regular;\n  font-size: 18px;\n  color: #555555;\n  line-height: 1.2;\n  border-bottom: 1px solid #0ae25d;\n  display: block;\n  width: 100%;\n  height: 45px;\n  background: transparent;\n  padding: 0 5px;\n}\n\n.login-btn {\n  font-size: 18px;\n  width: 100%;\n  display: block;\n  position: relative;\n  z-index: 1;\n  border-radius: 25px;\n  overflow: hidden;\n  margin: 0 auto;\n  line-height: 1.2;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 0 20px;\n  width: 100%;\n  height: 50px;\n  background-color: rgb(252, 164, 1);\n}\n\n.login-btn:hover {\n  left: 0;\n}\n\n.form_input_text {\n  position: absolute;\n  display: block;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  pointer-events: none;\n}\n\n.marker {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 18px;\n  height: 18px;\n  /* background-color: #000; */\n  border: 2px solid #fff;\n  border-radius: 100%;\n  user-select: none;\n  transform: translate(-50%, -50%);\n  background-image: url("+i+');\n}\n\n.box {\n  width: 70%;\n  height: 70px;\n  background-color: black;\n  color: #fff;\n  padding: 20px;\n  position: relative;\n  margin: 40px;\n  float: left;\n}\n\n.box.arrow-left:after {\n  content: " ";\n  position: absolute;\n  left: -15px;\n  top: 15px;\n  border-top: 15px solid transparent;\n  border-right: 15px solid black;\n  border-left: none;\n  border-bottom: 15px solid transparent;\n}\n.note {\n  color: gray;\n  margin: 8px 0;\n}\n\ninput.active:valid {\n  box-shadow: 0 0 5px 1px green;\n}\n\ninput.active:invalid {\n  box-shadow: 0 0 5px 1px red;\n}\n\n.error {\n  color: red;\n  font-size: 12px;\n  margin-top: 5px;\n}\n\n@-webkit-keyframes floatBubble {\n  0% {\n    left: 0%;\n  }\n  100% {\n    left: 40%;\n  }\n}\n@keyframes floatBubble {\n  0% {\n    left: 0%;\n  }\n  100% {\n    left: 40%;\n  }\n}\n\n@media (min-width: 800px) {\n  /* .user_conatainer {\n    min-height: calc(100vh - 150px);\n  } */\n  /* .logo {\n    width: 42vw;\n    max-width: 320px;\n    height: auto;\n    margin: 2vw auto 3vw auto;\n    cursor: pointer;\n    display: block;\n    width: 50%;\n  } */\n  \n  /* .logo img {\n    width: 42vw;\n    max-width: 320px;\n    height: auto;\n    margin: 2vw auto 3vw auto;\n    cursor: pointer;\n    display: block;\n    width: 50%;\n  } */\n}  \n\n@keyframes moveDown {\n  from {\n    transform: translateY(-5rem);\n  }\n  to {\n    transform: translateY(0rem);\n  }\n}\n\n@keyframes rotate {\n  0% {\n    transform: rotateY(360deg);\n  }\n  100% {\n    transform: rotateY(0rem);\n  }\n}\n\n.scrolled{\n  position: fixed;\n  top: 0;\n  left: 0;\n  background-color: lightblue;\n}',""]),e.exports=t},948:function(e){e.exports=JSON.parse("{}")},964:function(e,t){}});